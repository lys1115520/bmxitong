{"remainingRequest":"C:\\Users\\web\\Desktop\\projects\\mobiebm\\bmmobileapp\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\web\\Desktop\\projects\\mobiebm\\bmmobileapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\web\\Desktop\\projects\\mobiebm\\bmmobileapp\\src\\components\\bamobile\\common\\cart.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\web\\Desktop\\projects\\mobiebm\\bmmobileapp\\src\\components\\bamobile\\common\\cart.vue","mtime":1561777295986},{"path":"C:\\Users\\web\\Desktop\\projects\\mobiebm\\bmmobileapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"C:\\Users\\web\\Desktop\\projects\\mobiebm\\bmmobileapp\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"C:\\Users\\web\\Desktop\\projects\\mobiebm\\bmmobileapp\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  created: function created() {\n    this.login(); //是否登录\n\n    this.loadcart(); //加载购物车\n  },\n  destroyed: function destroyed() {\n    document.body.style.position = 'relative';\n    document.body.style.overflow = 'auto';\n  },\n  data: function data() {\n    return {\n      boolen: false,\n      islogin: false,\n      prolist: [],\n      ishavelist: false,\n      lcount: 1,\n      selected: [],\n      checked: false,\n      del: false\n    };\n  },\n  mounted: function mounted() {},\n  watch: {\n    $route: function $route(to, from) {\n      //监听地址栏变化 关闭模态框\n      this.boolen = false;\n      document.body.style.position = 'relative';\n      document.body.style.overflow = 'auto';\n    }\n  },\n  methods: {\n    backhome: function backhome() {\n      //弹层出现禁止body滚动条\n      if (this.boolen == true) {\n        this.boolen = false;\n        document.body.style.position = 'relative';\n        document.body.style.overflow = 'auto';\n      } else {\n        this.boolen = true;\n        document.body.style.position = 'fixed';\n        document.body.style.overflow = 'hidden';\n      }\n    },\n    login: function login() {\n      //是否登录\n      var uid = localStorage.getItem(\"uid\"); //console.log(uid);\n\n      if (!uid) {\n        this.islogin = false;\n        console.log(\"未登录\");\n      } else {\n        this.islogin = true;\n        console.log(\"已登录\");\n      }\n    },\n    loadcart: function loadcart() {\n      var _this = this;\n\n      //加载商品\n      var uid = localStorage.getItem(\"uid\");\n      var cartInfo = localStorage.cartInfo ? JSON.parse(localStorage.cartInfo) : [];\n\n      if (!uid) {\n        //未登录加载缓存\n        this.islogin = false;\n\n        if (cartInfo.length != 0) {\n          this.prolist = cartInfo;\n        } else {\n          this.ishavelist = true;\n        }\n      } else {\n        //已登录发送ajax请求\n        this.islogin = true;\n        var url = \"cart\";\n        var obj = {\n          uid: uid\n        };\n        this.axios.get(url, {\n          params: obj\n        }).then(function (result) {\n          var appcartInfo = result.data;\n          var Arry = appcartInfo.concat(cartInfo); //console.log(Arry);合并的购物车\n\n          function selectsigle(array) {\n            // 对象去重方法\n            var allArr = []; //建立新的临时数组\n\n            for (var i = 0; i < array.length; i++) {\n              var flag = true;\n\n              for (var j = 0; j < allArr.length; j++) {\n                if (array[i].lid == allArr[j].lid) {\n                  flag = false;\n                }\n\n                ;\n              }\n\n              ;\n\n              if (flag) {\n                allArr.push(array[i]);\n              }\n\n              ;\n            }\n\n            ;\n            return allArr;\n          }\n\n          var allcartInfo = selectsigle(Arry); //去重后的数组\n          //console.log(allcartInfo);\n\n          if (allcartInfo.length != 0) {\n            _this.prolist = allcartInfo;\n            localStorage.cartInfo = []; //清空缓存的数据\n          } else {\n            _this.ishavelist = true;\n          }\n        });\n      }\n    },\n    Touser: function Touser() {\n      //跳转登录页面\n      this.$router.push({\n        path: '/bama?key=user'\n      });\n    },\n    check_all: function check_all() {\n      var _this2 = this;\n\n      //全选按钮功能 \n      if (this.checked == false) {\n        this.selected = []; //先清空防止重复 再全添加\n\n        this.prolist.forEach(function (a) {\n          _this2.selected.push(a);\n        });\n      } else {\n        this.selected = [];\n      }\n    },\n    submit: function submit() {\n      //结算提交\n      console.log(\"tijiao \");\n    },\n    delpro: function delpro(e) {\n      var _this3 = this;\n\n      //删除商品\n      var lid = e.target.dataset.lid; //获取当前点击对象的自定义属性\n\n      var index = e.target.dataset.index;\n      var uid = localStorage.getItem(\"uid\"); //删除之前判断是否删除\n\n      this.$messagebox({\n        title: \"消息\",\n        message: \"是否删除商品\",\n        showConfirmButton: true,\n        showCancelButton: true\n      }).then(function (result) {\n        if (\"cancel\" == result) {\n          return;\n        } else {\n          if (!uid) {\n            //没登录删除缓存数据\n            _this3.prolist.splice(index, 1);\n\n            var cartInfo = JSON.parse(localStorage.cartInfo);\n            var newcartInfo = [];\n\n            for (var i = 0; i < cartInfo.length; i++) {\n              if (cartInfo[i].lid != lid) {\n                newcartInfo.push(cartInfo[i]);\n              }\n            }\n\n            ;\n            localStorage.cartInfo = JSON.stringify(newcartInfo); //更新本地缓存\n          } else {\n            //已登录删除服务器数据\n            //发送ajax删除商品\n            var url = \"del\";\n            var obj = {\n              lid: lid\n            };\n\n            _this3.axios.get(url, {\n              params: obj\n            }).then(function (result) {\n              //console.log(result)\n              //刷新\n              _this3.loadcart();\n            });\n          }\n        }\n      });\n    }\n  },\n  computed: {\n    //计算属性\n    getTotal: function getTotal() {\n      //计算总计\n      if (this.selected.length == this.prolist.length) {\n        //复选框全选中 则全选框选中\n        this.checked = true;\n      } else {\n        this.checked = false;\n      }\n\n      var totalPri = 0; //已选中列表的数量乘以价格 相加的和\n\n      for (var i = 0, len = this.selected.length; i < len; i++) {\n        totalPri += Number(this.selected[i].price) * Number(this.selected[i].lcount);\n      }\n\n      return {\n        totalNum: this.selected.length,\n        totalPrice: totalPri\n      };\n    }\n  }\n};",{"version":3,"sources":["cart.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div class=\"page-tabbar\">\r\n        <div class=\"container\">\r\n            <!-- 遮罩弹出层 -->\r\n            <div v-show=\"boolen\" class=\"surpermask\">\r\n                <ul>\r\n                    <li>\r\n                        <router-link :to=\"'/bama?key=index'\">\r\n                            <span class=\"iconfont icon-home\" ></span>首页\r\n                        </router-link>\r\n                    </li>\r\n                    <li>\r\n                        <router-link :to=\"'/bama?key=user'\">\r\n                            <span class=\"iconfont icon-user\" ></span>我的\r\n                        </router-link>\r\n                    </li>\r\n                    <li>\r\n                        <router-link :to=\"'/bama?key=prolist'\">\r\n                            <span class=\"iconfont icon-search\" ></span>搜索\r\n                        </router-link>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n            <!-- 头部登录提示框 -->\r\n            <div class=\"headmodule\">\r\n                <div @click=\"Touser()\" v-show=\"!islogin\">\r\n                  <a href=\"javascript:;\">登录</a>\r\n                </div>\r\n                <div v-show=\"islogin\">\r\n                  <a href=\"javascript:;\">欢迎</a>\r\n                </div>\r\n                <p v-show=\"!islogin\">登录后可同步购物车里的商品</p>\r\n                <p v-show=\"islogin\">欢迎来到购物车</p>\r\n                <span @click=\"del=!del\" v-show=\"!del\">编辑</span>\r\n                <span @click=\"del=!del\" v-show=\"del\">完成</span>\r\n                <span class=\"iconfont icon-viewgallery\" @click=\"backhome\"></span>\r\n            </div>\r\n            <!-- 购物车列表 -->\r\n            <div class=\"bodycontent\">\r\n                <div class=\"salemsgdiv\">\r\n                    <div class=\"salemsg\">\r\n                        <label class=\"salemsgleft\">\r\n                            <input type=\"checkbox\" v-model=\"checked\" @click=\"check_all()\">\r\n                            <span></span>\r\n                            <span>平台自营</span>\r\n                        </label>\r\n                        <div class=\"salemsgright\">\r\n                            <span>全场包邮</span>\r\n                            <span>领取优惠劵</span>\r\n                        </div>\r\n                    </div>\r\n                </div>               \r\n                <!-- 购物车商品列表 -->\r\n                <div v-show=\"ishavelist\">\r\n                    没有商品去首页看看\r\n                </div>\r\n\r\n                <ul class=\"prolist\">\r\n                    <li class=\"prolistItem\" v-for=\"(item,index) in prolist\" :key=\"index\">\r\n                        <label class=\"salemsgleft checkbox\">\r\n                            <input type=\"checkbox\" v-model=\"selected\"\r\n                            :value=\"item\">\r\n                            <span></span>\r\n                        </label>\r\n                        <div class=\"prolistImg\"><img :src=\"'http://127.0.0.1:3000/'+item.pic\" width=\"100%\" alt=\"\"></div>\r\n                        <div class=\"promsg\">\r\n                            <a href=\"#\" class=\"protitle\">{{item.titles}}</a>\r\n                            <p class=\"propec\"> 规格 ：<span>主商品</span></p>\r\n                            <div class=\"pricecount\">\r\n                                <span class=\"proprice\">￥{{item.price.toFixed(2)}}</span>\r\n                                <div class=\"procount\" v-show=\"!del\">\r\n                                    <a href=\"javascript:;\" @click=\"item.lcount>1?item.lcount--:''\"><i class=\"iconfont icon-minus-square\"></i></a>\r\n                                    <span>{{item.lcount}}</span>\r\n                                    <a href=\"javascript:;\" @click=\"item.lcount<99?item.lcount++:''\"><i class=\"iconfont icon-plus-square\"></i></a>\r\n                                </div>\r\n                                <div v-show=\"del\" style=\"color:red;height:1.5em\">\r\n                                    <span @click=\"delpro\" :data-index=\"index\" :data-lid=\"item.lid\">删除</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                        </div>\r\n                    </li>\r\n                    <!-- <li class=\"prolistItem\">\r\n                        <label class=\"salemsgleft checkbox\"><input type=\"checkbox\" checked><span></span></label>\r\n                        <div class=\"prolistImg\"><img src=\"../../../assets/image/common/checkedfalse.png\" width=\"100%\" alt=\"\"></div>\r\n                        <div class=\"promsg\">\r\n                            <a href=\"#\" class=\"protitle\">八马茶叶 金骏眉茶叶 武夷山桐木关金骏眉红茶礼盒装148克</a>\r\n                            <p class=\"propec\"> 规格 ：<span>主商品</span></p>\r\n                            <div class=\"pricecount\">\r\n                                <span class=\"proprice\">￥33.0</span>\r\n                                <div class=\"procount\">\r\n                                    <a href=\"#\"><i class=\"iconfont icon-minus-square\"></i></a>\r\n                                    <input type=\"text\" value=\"1\">\r\n                                    <a href=\"#\"><i class=\"iconfont icon-plus-square\"></i></a>\r\n                                </div>\r\n                            </div>\r\n\r\n                        </div>\r\n                    </li>  -->\r\n\r\n                </ul>\r\n            </div>\r\n            <!-- 底部全选结算栏 -->\r\n            <div class=\"footmodule\">\r\n                <div class=\"leftcheckall\">\r\n                    <label class=\"salemsgleft checkbox\">\r\n                        <input type=\"checkbox\" v-model=\"checked\" @click=\"check_all()\">\r\n                        <span></span>\r\n                        <b>全选</b>\r\n                    </label>\r\n                    <div class=\"footp\">\r\n                        <p>合计 : <span>￥{{getTotal.totalPrice}}.00</span></p>\r\n                        <p>(不含运费，已优惠<span>￥0.00</span>)</p>\r\n                    </div>\r\n                </div>\r\n                <div class=\"rightbtn\" >\r\n                    <button :class={active:del} @click=\"!del && submit()\">\r\n                        结算( <span>{{getTotal.totalNum}}</span> )\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div> \r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    created(){\r\n        this.login();//是否登录\r\n        this.loadcart();//加载购物车\r\n\r\n            \r\n    },\r\n    destroyed(){\r\n        document.body.style.position = 'relative';\r\n        document.body.style.overflow = 'auto';\r\n    },\r\n    data() {\r\n        return {\r\n            boolen:false,\r\n            islogin:false,\r\n            prolist:[],\r\n            ishavelist:false,\r\n            lcount:1,\r\n            selected:[],\r\n            checked:false,\r\n            del:false,\r\n            \r\n        }\r\n    },\r\n    mounted(){\r\n       \r\n    },\r\n\r\n    watch:{\r\n        $route(to,from){//监听地址栏变化 关闭模态框\r\n            this.boolen=false;\r\n            document.body.style.position = 'relative';\r\n            document.body.style.overflow = 'auto';\r\n        }  \r\n    },\r\n    methods:{\r\n        backhome(){//弹层出现禁止body滚动条\r\n            if(this.boolen==true){\r\n                this.boolen=false;\r\n                document.body.style.position = 'relative';\r\n                document.body.style.overflow = 'auto';\r\n            }else{\r\n                this.boolen=true;\r\n                document.body.style.position = 'fixed';\r\n                document.body.style.overflow = 'hidden';\r\n            }\r\n        },\r\n        login(){//是否登录\r\n            var uid=localStorage.getItem(\"uid\");\r\n            //console.log(uid);\r\n            if(!uid){\r\n                this.islogin=false;\r\n                console.log(\"未登录\")\r\n            }else{\r\n                this.islogin=true;\r\n                console.log(\"已登录\")\r\n            }\r\n        },\r\n        loadcart(){//加载商品\r\n            var uid=localStorage.getItem(\"uid\");\r\n            let cartInfo=localStorage.cartInfo?JSON.parse(localStorage.cartInfo):[];\r\n            if(!uid){//未登录加载缓存\r\n                this.islogin=false;\r\n                if(cartInfo.length!=0){\r\n                    this.prolist=cartInfo;\r\n                }else{\r\n                    this.ishavelist=true;\r\n                }\r\n            }else{//已登录发送ajax请求\r\n                this.islogin=true;\r\n                var url=\"cart\";\r\n                var obj={uid:uid};\r\n                this.axios.get(url,{params:obj}).then(result=>{\r\n                    var appcartInfo=result.data;\r\n                    var Arry=appcartInfo.concat(cartInfo);\r\n                    //console.log(Arry);合并的购物车\r\n                    function selectsigle(array){     // 对象去重方法\r\n                        var allArr = [];    //建立新的临时数组\r\n                        for(var i=0;i<array.length;i++){\r\n                            var flag = true;\r\n                        　    for(var j=0;j<allArr.length;j++){\r\n                                if(array[i].lid == allArr[j].lid){\r\n                        　　　　　   flag = false;\r\n                            　　    };\r\n                            };\r\n                            if(flag){\r\n                            　　allArr.push(array[i]);\r\n                            };\r\n                        };\r\n                        return allArr;\r\n                    }　      　\r\n                    var allcartInfo=selectsigle(Arry);//去重后的数组\r\n                    //console.log(allcartInfo);\r\n                    if(allcartInfo.length!=0){\r\n                        this.prolist=allcartInfo;\r\n\r\n                        localStorage.cartInfo=[];//清空缓存的数据\r\n                    }else{\r\n                        this.ishavelist=true;\r\n                    }      \r\n                });\r\n            }\r\n        },\r\n        Touser(){//跳转登录页面\r\n            this.$router.push({path:'/bama?key=user'})\r\n        },\r\n        check_all(){//全选按钮功能 \r\n            if(this.checked==false){\r\n                this.selected = [];//先清空防止重复 再全添加\r\n                this.prolist.forEach(a => {\r\n                    this.selected.push(a)\r\n                })\r\n            } else{\r\n                this.selected = []\r\n            }\r\n        },\r\n        submit(){//结算提交\r\n            console.log(\"tijiao \")\r\n        },\r\n        delpro(e){//删除商品\r\n            var lid = e.target.dataset.lid;//获取当前点击对象的自定义属性\r\n            var index = e.target.dataset.index;\r\n            var uid=localStorage.getItem(\"uid\");\r\n            //删除之前判断是否删除\r\n            this.$messagebox({\r\n               title:\"消息\",\r\n               message:\"是否删除商品\",\r\n               showConfirmButton:true,\r\n               showCancelButton:true,\r\n            }).then(result=>{\r\n                if(\"cancel\"==result){\r\n                    return\r\n                }else{\r\n                    if(!uid){//没登录删除缓存数据\r\n                        this.prolist.splice(index,1);\r\n                        var cartInfo=JSON.parse(localStorage.cartInfo);\r\n                        var newcartInfo=[];\r\n                        for(var i=0;i<cartInfo.length;i++){\r\n                            if(cartInfo[i].lid!=lid){\r\n                                newcartInfo.push(cartInfo[i]);\r\n                            }\r\n                        };\r\n                        localStorage.cartInfo=JSON.stringify(newcartInfo);//更新本地缓存\r\n                    }else{//已登录删除服务器数据\r\n                        //发送ajax删除商品\r\n                        var url = \"del\"\r\n                        var obj = {lid:lid}\r\n                        this.axios.get(url,{params:obj}).then(result=>{\r\n                        //console.log(result)\r\n                        //刷新\r\n                        this.loadcart();\r\n                        });\r\n                    }\r\n                }\r\n            });  \r\n        },\r\n\r\n    },\r\n    computed:{//计算属性\r\n        getTotal:function(){//计算总计\r\n             if(this.selected.length==this.prolist.length){//复选框全选中 则全选框选中\r\n                 this.checked=true;\r\n             }else{\r\n                 this.checked=false;\r\n             }\r\n            var totalPri = 0;//已选中列表的数量乘以价格 相加的和\r\n            for (var i = 0,len = this.selected.length; i < len; i++) {\r\n                totalPri+=Number(this.selected[i].price)*Number(this.selected[i].lcount);\r\n            }\r\n            return {totalNum:this.selected.length,totalPrice:totalPri}\r\n\t\t},\r\n\r\n    }\r\n\r\n} \r\n</script>\r\n\r\n<style scoped>\r\nbutton.active{\r\n    color: #999 !important;\r\n    \r\n}\r\n.page-tabbar{\r\n  overflow: hidden;/*溢出隐藏*/\r\n}\r\n.page-tabbar>.container{\r\n  font-size: 1.0em;\r\n  font-family:\"Microsoft YaHei\";\r\n}\r\n.container{\r\n  overflow:auto;/*溢出显示轮动条*/\r\n  padding-bottom: 5em;\r\n  \r\n}\r\n.headmodule{\r\n    display: flex;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    width: 100%;\r\n    height: 2.9em; \r\n    border-bottom: 1px solid #ddd;\r\n    position: fixed;\r\n}\r\n.headmodule>div{\r\n    width:15%;\r\n    height: 2em;\r\n    line-height: 2em;\r\n    border: 1px solid red;\r\n    border-radius: 0.3em;\r\n    text-align: center;\r\n}\r\n/* 购物车主体 */\r\n.bodycontent{\r\n    margin-top:3em;\r\n}\r\n/* 全选框 和复选框的美化 */\r\nlabel input{\r\n    appearance: none;\r\n    -webkit-appearance: none;\r\n    outline: none;\r\n    display: none;\r\n}\r\nlabel input[type=\"checkbox\"]+span{\r\n    margin-right:0.5em;\r\n    width:1.4em;height:1.4em;\r\n    display:inline-block;\r\n    background:url('../../../assets/image/common/checkedfalse.png') no-repeat;\r\n    background-size:1.4em 1.4em;\r\n    background-position:0 0;}\r\nlabel input[type=\"checkbox\"]:checked+span{\r\n    background:url('../../../assets/image/common/checkedtrue.png') no-repeat;\r\n    background-size:1.4em 1.4em;\r\n    background-position:0 0;\r\n}\r\n.salemsgleft{\r\n    display: flex;\r\n    align-items: center;\r\n    font-size: 0.9em;\r\n}\r\n.salemsg,.salemsgright{\r\n    display: flex;\r\n    width: 100%;\r\n    height: 3em;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n.salemsgleft,.salemsgright{\r\n    width: 50%;\r\n    height: 100%;\r\n    line-height:3em;\r\n}\r\n.salemsgright span:first-child{\r\n    color: #999;\r\n    font-size: 0.9em;\r\n}\r\n.salemsgright span:last-child{\r\n    color: #E63D59;\r\n    font-size: 0.93em;\r\n}\r\n/* 购物车商品列表 */\r\n.prolist{\r\n    border: 1px solid #ddd;\r\n    font-size: 1em;\r\n}\r\n.salemsgdiv,.prolistItem{\r\n    padding:0 1em;\r\n} \r\n.prolistItem{\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n.prolistImg{\r\n    width: 11em;\r\n    height: 5.9em;\r\n    border: 1px solid #ddd;\r\n    margin: 0.5em;\r\n    box-shadow: #999 0.09em 0.09em;\r\n}\r\n.checkbox{width: 2em;}\r\n.pricecount,.procount{\r\n    display:flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n.pricecount span{\r\n    width: 1.5em;\r\n    text-align: center;\r\n}\r\n.protitle{\r\n    display: block;\r\n    width: 14em;\r\n    height: 3em;\r\n    line-height: 1.45em;\r\n    font-size: 0.9em;\r\n    color: black;\r\n    overflow: hidden;\r\n}\r\n.proprice{\r\n    color: #E63D59;\r\n}\r\n.propec{\r\n    color: #999;\r\n    font-size: 0.9em;\r\n    margin-top: 0.4em;\r\n}\r\n/* 底部全选结算栏 */\r\n.footmodule{\r\n    width: 100%;\r\n    position: fixed;\r\n    background-color: #fff;\r\n    bottom: 0;\r\n    z-index: 999;\r\n}\r\n.leftcheckall{\r\n    width: 75%;\r\n    height: 3.4em; \r\n    padding-left: 1em;\r\n    border: 1px solid #ddd;\r\n    background-color: #ddd;\r\n}\r\n.footmodule,.leftcheckall{\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n.leftcheckall .checkbox{\r\n    width: 25%;\r\n}\r\n.footp{\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    text-align: right;\r\n    padding-right: 0.4em;\r\n    width: 75%;\r\n    height:3.5em;\r\n}\r\n.footp p:last-child{\r\n    font-size: 0.9em;\r\n    color: #999;\r\n}\r\n.rightbtn{\r\n    width: 25%;\r\n    height:3.5em;\r\n    line-height: 3.5em;\r\n    text-align: center;\r\n    \r\n}\r\n.rightbtn button{\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #E63D59;\r\n    color: #fff;\r\n    outline: none;\r\n    border: none;\r\n}\r\n.surpermask{\r\n    position: fixed;\r\n    z-index: 1000;\r\n    width: 100%;\r\n    left: 0;\r\n    top: 2.8rem;\r\n    bottom: 0;\r\n    background: rgba(0, 0, 0, .5);\r\n}\r\n.surpermask>ul{\r\n    width: 30%;\r\n    position: absolute;\r\n    right: 1em;\r\n    top: 1em;\r\n    background-color: aliceblue;\r\n    border-radius: 0.5em;\r\n    text-align: center;\r\n}\r\n.surpermask>ul li{\r\n    width: 100%;\r\n    height: 2.8em;\r\n    line-height: 2.8em;\r\n    border-bottom: 1px solid #999;\r\n}\r\n.surpermask>ul li:last-child{\r\n    border: none;\r\n}\r\n</style>\r\n"],"sourceRoot":"src\\components\\bamobile\\common"}]}